var FaqManager=function(){function a(b,c){this.faqs=b,this.options={},this.options=$.extend(!0,{},a.DEFAULTS,c||{}),this.init(),this.initCreateEvents(),this.initUpdateEvents(),this.initDeleteEvents()}return a.prototype.init=function(){this.createForm=$("form[name='"+this.getCreate("createFormName")+"']"),this.createLoader=this.createForm.find(".loader"),this.createFormBtn=$(this.getCreate("updateFormBtnClass")),this.editBtns=$(this.getUpdate("editBtnClass")),this.updateForm=$("form[name='"+this.getUpdate("updateFormName")+"']"),this.updateLoader=this.updateForm.find(".loader"),this.updateFormBtn=this.updateForm.find(this.getUpdate("updateFormBtnClass")),this.deleteBtns=$(this.getDelete("deleteBtnClass"))},a.prototype.initCreateEvents=function(){var a=this;this.createForm.on("submit",function(){return a.createFormBtn.hide(),a.createLoader.show(),$.ajax({url:a.getCreate("createUrl"),type:"POST",data:$(this).serialize()}).done(function(b){b.error===!1?(a.getCreate("onDone")(b.msg,b.datas),a.faqs.push(b.datas)):a.getCreate("onFail")(b.msg,b.datas),a.createFormBtn.show(),a.createLoader.hide()}).fail(function(b){a.getCreate("onServerFail")(b.statusCode+" "+b.statusText),a.createFormBtn.show(),a.createLoader.hide()}),!1})},a.prototype.initUpdateEvents=function(){var a=this;$(document).on("click",this.getUpdate("editBtnClass"),function(b){b.preventDefault();var c=$(this).data("id"),d=a.getById(parseInt(c));null!=d&&a.dispatchDatasInUpdateForm(d)}),this.updateForm.on("submit",function(){if(""==$(this).data("id"))return!1;var b=a.getUpdate("updateUrl")+"&id="+$(this).data("id");return a.updateFormBtn.hide(),a.updateLoader.show(),$.ajax({type:"POST",url:b,data:$(this).serialize()}).done(function(b){b.error===!1?a.getUpdate("onDone")(b.msg,b.datas):a.getUpdate("onFail")(b.msg,b.datas),console.log(b),a.updateFormBtn.show(),a.updateLoader.hide()}).fail(function(b){a.getUpdate("onServerFail")(b.statusCode+" "+b.statusText),a.updateFormBtn.show(),a.updateLoader.hide()}),!1})},a.prototype.initDeleteEvents=function(){var a=this;$(document).on("click",this.getDelete("deleteBtnClass"),function(b){b.preventDefault();var c=$(this).data("id"),d=a.getIndex(parseInt(c));if(null!=d){var e=$(this),f=a.getDelete("deleteUrl")+"&id="+c,g={id:c},h=$(this).next(".loader");e.hide(),h.show(),$.ajax({url:f,type:"DELETE",data:g}).done(function(b){b.error===!1?(b.datas.id=c,a.getDelete("onDone")(b.msg,b.datas),a.faqs.splice(d,1)):a.getDelete("onFail")(b.msg,b.datas),e.show(),h.hide()}).fail(function(b){e.show(),h.hide(),a.getDelete("onServerFail")(b.statusCode+" "+b.statusText)})}})},a.prototype.dispatchDatasInUpdateForm=function(a){this.updateForm.data("id",a.id),this.updateForm.find("#update_faq_form_question").val(a.question),this.updateForm.find("#update_faq_form_response").val(a.response),this.updateForm.find("#update_faq_form_site").val(a.site.id)},a.prototype.getCreate=function(a){return this.options.creation.hasOwnProperty(a)?this.options.creation[a]:""},a.prototype.getUpdate=function(a){return this.options.update.hasOwnProperty(a)?this.options.update[a]:""},a.prototype.getDelete=function(a){return this.options["delete"].hasOwnProperty(a)?this.options["delete"][a]:""},a.prototype.getById=function(a){var b=null;return $.each(this.faqs,function(c,d){d.id==a&&(b=d)}),b},a.prototype.getIndex=function(a){var b=null;return $.each(this.faqs,function(c,d){d.id==a&&(b=c)}),1},a.DEFAULTS={creation:{createFormName:"",createUrl:"",updateFormBtnClass:"",onDone:function(){},onFail:function(){},onServerFail:function(){}},update:{updateFormName:"",updateUrl:"",editBtnClass:"",updateFormBtnClass:"",onDone:function(){},onFail:function(){},onServerFail:function(){}},"delete":{deleteBtnClass:"",deleteUrl:"",onDone:function(){},onFail:function(){},onServerFail:function(){}}},a}();