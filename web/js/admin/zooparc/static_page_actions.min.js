var StaticPageAdd=function(){function a(b,c){this.pages=b,this.options={},this.options=$.extend(!0,{},a.DEFAULTS,c||{}),this.form=$(this.options.formId),this.container=$(this.options.containerId),this.messenger=$(".messenger",this.container),this.loader=$(this.options.loaderClass,this.form),this.pageList=$(this.options.pagesListId),console.log(this.pageList),this.loader.hide(),this.saveBtn=$(this.options.saveBtnId,this.form),this.initEvent()}return a.prototype.modifyTable=function(a){if(this.pageList.length<1)return!1;var b=$("<tr />",{id:"page_row_"+a.id});b.append($("<td />",{"class":"page_cell_title",text:a.title})),b.append($("<td />",{"class":"page_cell_name",text:a.name})),b.append($("<td />",{"class":"page_cell_url",text:a.url})),b.append($("<td />").append("<button class='btn btn-default display-page' id='dis_page_"+a.id+"' data-page='"+a.id+"'><i class='fa fa-plus'></i></button>")),b.append($("<td />").append("<button class='btn btn-default delete-page' id='del_page_"+a.id+"' data-page='"+a.id+"' ><i class='fa fa-trash-o'></i></button>")),this.pageList.append(b)},a.prototype.save=function(){var a,b=this,c="Problème !",d={name:$(this.options.ipt_name).val(),route:$(this.options.ipt_route).val(),title:$(this.options.ipt_title).val(),description:$(this.options.ipt_description).val(),parent:$(this.options.ipt_parent).val(),keywords:$(this.options.ipt_keywords).val()};this.messenger.empty(),this.saveBtn.hide(),this.loader.show(),a=this.options.alertHTML,$.ajax({url:this.options.saveUrl,type:"POST",data:d}).done(function(d){0==d.error?(c="Succès !",a=a.replace("[[type]]",b.options.successClass),b.pages.push(d.datas),b.modifyTable(d.datas)):a=a.replace("[[type]]",b.options.alertClass),a=a.replace("[[title]]",c).replace("[[msg]]",d.msg),b.messenger.html(a),b.saveBtn.show(),b.loader.hide()}).fail(function(d){a=a.replace("[[type]]",b.options.alertClass).replace("[[title]]",c).replace("[[msg]]",d.statusCode+" "+d.statusText),b.messenger.html(a),b.saveBtn.show(),b.loader.hide()})},a.prototype.initEvent=function(){var a=this;this.saveBtn.on("click",function(b){return b.preventDefault(),""==a.options.saveUrl?!1:(console.log("click"),void a.save())})},a.DEFAULTS={formId:"#add-page-form",containerId:"#add-page",pagesListId:"",saveUrl:"",saveBtnId:"#add-page-btn",loaderClass:".loader",ipt_name:"#spa-name",ipt_route:"#spa-route",ipt_title:"#spa-title",ipt_description:"#spa-description",ipt_parent:"#spa-parent",ipt_keywords:"#spa-keywords",dangerClass:"alert-danger",successClass:"alert-success",alertHTML:"<div class='alert [[type]] alert-dismissible fade in' role='alert'><button class='close' data-dismiss='alert' type='button'><span aria-hidden='true'>&times;</span><span class='sr-only'>close</span></button><h4>[[title]]</h4><p>[[msg]]</p></div>"},a}(),StaticPageModifier=function(){function a(b,c){this.pages=b,this.options={},this.currentPageId=null,this.currentPage=null,this.index=null,this.options=$.extend(!0,{},a.DEFAULTS,c||{}),this.container=$(this.options.containerId),this.messenger=this.container.find(".messenger"),this.form=$(this.options.formId),this.saveBtn=$(this.options.saveBtnId),this.loader=this.form.find(".loader"),this.loader.hide(),this.initEvents()}return a.prototype.clearForm=function(){$(this.options.ipt_name).val(""),$(this.options.ipt_slug).val(""),$(this.options.ipt_route).val(""),$(this.options.ipt_url).val(""),$(this.options.ipt_title).val(""),$(this.options.ipt_description).val(""),$(this.options.ipt_keywords).val(""),$(this.options.ipt_parent).val("")},a.prototype.formFill=function(){var a;this.clearForm(),this.currentPage=this.getPage(this.currentPageId);for(a in this.currentPage)this.currentPage.hasOwnProperty(a)&&null!=this.currentPage[a]&&$(this.options["ipt_"+a]).val(this.currentPage[a]+"");this.showForm()},a.prototype.showForm=function(){this.container.show()},a.prototype.getPage=function(a){var b=null,c=this;return $.each(this.pages,function(d,e){e.id===a&&(b=e,c.index=d)}),b},a.prototype.modifyTable=function(){var a,b="#page_row_"+this.currentPageId;a=$(b),$("td.page_cell_title",a).text(this.currentPage.title),$("td.page_cell_name",a).text(this.currentPage.name),$("td.page_cell_url",a).text(this.currentPage.url)},a.prototype.savePage=function(){var a,b=this,c="Problème !",d={id:this.currentPageId,name:$(this.options.ipt_name).val(),route:$(this.options.ipt_route).val(),title:$(this.options.ipt_title).val(),description:$(this.options.ipt_description).val(),parent:$(this.options.ipt_parent).val(),keywords:$(this.options.ipt_keywords).val()};this.messenger.empty(),this.saveBtn.hide(),this.loader.show(),a=this.options.alertHTML,$.ajax({url:this.options.saveUrl,type:"PUT",data:d}).done(function(d){0==d.error?(b.pages[b.index]=d.datas,b.currentPage=d.datas,b.formFill(),c="Succès !",a=a.replace("[[type]]",b.options.successClass),b.modifyTable()):a=a.replace("[[type]]",b.options.alertClass),a=a.replace("[[title]]",c).replace("[[msg]]",d.msg),b.messenger.html(a),b.saveBtn.show(),b.loader.hide()}).fail(function(d){a=a.replace("[[type]]",b.options.alertClass).replace("[[title]]",c).replace("[[msg]]",d.statusCode+" "+d.statusText),b.messenger.html(a),b.saveBtn.show(),b.loader.hide()})},a.prototype.initEvents=function(){var a=this;$(document).on("click",this.options.buttonClass,function(b){b.preventDefault(),a.currentPageId=$(this).data("page"),a.formFill()}),this.saveBtn.on("click",function(b){b.preventDefault(),a.savePage()})},a.DEFAULTS={formId:"#static-page-modifier-form",containerId:"#static-page-modifier",ipt_name:"#spm-name",ipt_slug:"#spm-slug",ipt_route:"#spm-route",ipt_url:"#spm-url",ipt_title:"#spm-title",ipt_description:"#spm-description",ipt_parent:"#spm-parent",ipt_keywords:"#spm-keywords",buttonClass:".display-page",saveBtnId:"#save-modif-btn",saveUrl:"",dangerClass:"alert-danger",successClass:"alert-success",alertHTML:"<div class='alert [[type]] alert-dismissible fade in' role='alert'><button class='close' data-dismiss='alert' type='button'><span aria-hidden='true'>&times;</span><span class='sr-only'>close</span></button><h4>[[title]]</h4><p>[[msg]]</p></div>"},a}(),StaticPageDelete=function(){function a(b,c){this.pages=b,this.options={},this.options=$.extend(!0,{},a.DEFAULTS,c||{}),this.container=$(this.options.containerId),this.loader=$(".loader",this.container),this.loader.hide(),this.messenger=$(".messenger",this.container),this.pageList=$(this.options.pagesListId),this.initEvents()}return a.prototype.getPage=function(a){var b=null;return $.each(this.pages,function(c,d){d.id===a&&(b=[c,d])}),b},a.prototype.removeDatas=function(a){var b=this.getPage(a.id);null!==b&&this.pages.splice(b[0],1)},a.prototype.modifyTable=function(a){if(this.pageList.length<1)return!1;var b=this.pageList.find("tr#page_row_"+a.id);return b.length<1?!1:(b.remove(),!0)},a.prototype.removePage=function(a){var b,c=this,d="Problème !";this.messenger.empty(),this.loader.show(),b=this.options.alertHTML,$.ajax({url:this.options.deleteUrl,type:"DELETE",data:a[1]}).done(function(a){0==a.error?(d="Succès !",b=b.replace("[[type]]",c.options.successClass),c.modifyTable(a.datas),c.removeDatas(a.datas)):b=b.replace("[[type]]",c.options.alertClass),b=b.replace("[[title]]",d).replace("[[msg]]",a.msg),c.messenger.html(b),c.loader.hide()}).fail(function(a){b=b.replace("[[type]]",c.options.alertClass).replace("[[title]]",d).replace("[[msg]]",a.statusCode+" "+a.statusText),c.messenger.html(b),c.loader.hide()})},a.prototype.initEvents=function(){var a=this;$(document).on("click",this.options.deleteBtnClass,function(b){if(b.preventDefault(),window.confirm(a.options.confirmMsg)){var c=$(this).data("page");a.removePage(a.getPage(c))}})},a.DEFAULTS={deleteBtnClass:".delete-page",containerId:"#pages",pagesListId:"",confirmMsg:"Attention cette action est définitive. Poursuivre ?",deleteUrl:"",dangerClass:"alert-danger",successClass:"alert-success",alertHTML:"<div class='alert [[type]] alert-dismissible fade in' role='alert'><button class='close' data-dismiss='alert' type='button'><span aria-hidden='true'>&times;</span><span class='sr-only'>close</span></button><h4>[[title]]</h4><p>[[msg]]</p></div>"},a}();